$.fn.preload=function(){this.each(function(){var img=new Image;img.src=this})};var preloadImages=[];$(".preload-bg").each(function(){preloadImages.push($(this).css("background-image").replace("url(","").replace(")","").replace(/\"/gi,""))});$(preloadImages).preload();var videoPlaying=false,introVideo;(function($,viewport){var bootstrap4Divs={xs:$('<div class="device-xs d-block hidden-sm-up"></div>'),sm:$('<div class="device-sm d-block hidden-xs-down hidden-md-up"></div>'),md:$('<div class="device-md d-block hidden-sm-down hidden-lg-up"></div>'),lg:$('<div class="device-lg d-block hidden-md-down hidden-xl-up"></div>'),xl:$('<div class="device-xl d-block hidden-lg-down"></div>')};viewport.use("bootstrap4",bootstrap4Divs);var $video=$(".video"),$videoCover=$(".video-cover"),$homeRight=$(".home-right"),$homeLeft=$(".home-left"),$topRow=$(".main-home-row"),curBreakpoint,isMobile=false,rightHeight,maxWidth,windowWidth,videoWidth,widthIncrease,useVideoWidth;var smallBreaks=["xs","sm"],largeBreaks=["md","lg","xl"];var reflow=function reflowF(evt,tweenCompleteFunction){var doTween=evt==="tween",timeline;if(doTween){timeline=new TimelineLite({paused:true})}if(!isMobile){var minHeight=$(".home-left-hmid").outerHeight();$homeRight.add($homeLeft).css({minHeight:minHeight+"px"});rightHeight=$homeRight.height();windowWidth=$(window).width();maxWidth=videoPlaying?windowWidth:rightHeight/9*16;videoWidth=windowWidth*.58;if(maxWidth>windowWidth){maxWidth=windowWidth}widthIncrease=videoPlaying?maxWidth-videoWidth:0;if(widthIncrease<0){widthIncrease=0}var topRowObj={width:windowWidth+widthIncrease+"px",marginLeft:widthIncrease*-1+"px"};if(videoPlaying){if(doTween){timeline.to($topRow[0],.3,topRowObj,0)}else{TweenLite.set($topRow[0],topRowObj)}useVideoWidth=maxWidth}else{if(doTween){timeline.to($topRow[0],.3,topRowObj,0)}else{TweenLite.set($topRow[0],{width:"",marginLeft:""})}useVideoWidth=videoWidth}var videoCSSObj={maxWidth:maxWidth+"px",width:useVideoWidth,minHeight:minHeight+"px"};if(doTween){if(tweenCompleteFunction){timeline.eventCallback("onComplete",tweenCompleteFunction)}else{timeline.eventCallback("onComplete",null)}timeline.to($video[0],.3,videoCSSObj,0).play()}else{TweenLite.set($video[0],videoCSSObj)}return reflowF}else if(tweenCompleteFunction){tweenCompleteFunction()}}();function changeLayout(type){var restartVideo=videoPlaying;switch(type){case"mobile":isMobile=true;$video.appendTo(".mobile-video-holder");$homeRight.hide();$homeRight.add($homeLeft).css({minHeight:""});TweenLite.set($topRow[0],{width:"",marginLeft:""});TweenLite.set($video[0],{maxWidth:"",width:"",minHeight:""});introVideo.resize("100%","auto");break;case"desktop":isMobile=false;$video.appendTo($homeRight);$homeRight.show();introVideo.resize("auto","100%");reflow();break}if(restartVideo){setTimeout(function(){videoPlaying=true;introVideo.play(true)},10)}}$(function(){viewport.breakpointChanged(function(newBreakpoint,oldBreakpoint){if(oldBreakpoint===null){if(smallBreaks.indexOf(newBreakpoint)!==-1){changeLayout("mobile")}}else{if(smallBreaks.indexOf(newBreakpoint)!==-1&&largeBreaks.indexOf(oldBreakpoint)!==-1){changeLayout("mobile")}else if(largeBreaks.indexOf(newBreakpoint)!==-1&&smallBreaks.indexOf(oldBreakpoint)!==-1){changeLayout("desktop")}}});$(window).resize(reflow)});(function(){introVideo=jwplayer("videoPlayer");introVideo.setup({sources:[{file:"//content.jwplatform.com/manifests/JpuXFVbD.m3u8?sig=ea38f26da3a2609f827097776e7cfcbc",label:"HLS"},{file:"//content.jwplatform.com/videos/JpuXFVbD-aHTOGd7Q.mp4",label:"1080p"},{file:"//content.jwplatform.com/videos/JpuXFVbD-xhTL5q8u.mp4",label:"720p"}],image:"//content.jwplatform.com/thumbs/JpuXFVbD-1920.jpg",mediaid:"JpuXFVbD",abouttext:"Stop Smoking Advisor",aboutlink:"https://www.stopsmokingadvisor.net",height:"100%",width:"auto",preload:true,hlshtml:true});var vidPlay=function(){new TweenLite.to(".play-button",.3,{x:"100%"});videoPlaying=true;reflow("tween",function(){introVideo.play(true)})},vidStopped=function(){$(".play-button").removeClass("link-clicked");new TweenLite.to(".play-button",.3,{x:"0%"});videoPlaying=false;reflow("tween")};introVideo.setControls(false);introVideo.on("displayClick",function(){if(videoPlaying){introVideo.pause(true)}else{vidPlay()}});introVideo.on("ready",function(){$(".play-button").on("click",function(e){e.preventDefault();e.stopPropagation();if(!videoPlaying){vidPlay()}});$(".video-cover .jw-flag-controls-disabled .jw-media").css({cursor:"pointer"});introVideo.on("pause",vidStopped);introVideo.on("complete",vidStopped)})})()})(jQuery,ResponsiveBootstrapToolkit);$(".opacity-0").css({opacity:"",visibility:""});$(".opacity-0").removeClass("opacity-0");var playButtonTween=new TweenLite.from(".play-button",.45,{opacity:0,x:"20%",paused:true});var introTimeline=new TimelineLite({paused:true,delay:.6}).from(".home-left",.45,{opacity:0,x:-30}).from(".home-right",.45,{opacity:0,y:-30},"-=0.15").from(".bottom-links",.45,{opacity:0,y:30},"-=0.15").add(function(){if(!videoPlaying){playButtonTween.play()}else{TweenLite.set(".play-button",{opacity:1})}});$(function(){introTimeline.play()});$.fn.linkTextSize=function(action){this.each(function(){var $el=$(this);switch(action){default:$el.on("click",function(){setTimeout(function(){$el.removeClass("link-clicked").addClass("link-clicked");var resetTime=typeof $el.attr("data-size-reset")=="undefined"?1200:$el.attr("data-size-reset")=="false"?false:$el.attr("data-size-reset")/1;if(resetTime!==false){if($el.data("resetTimeout")){clearTimeout($el.data("resetTimeout"))}$el.data("resetTimeout",setTimeout(function(){$el.linkTextSize("reset")},resetTime))}},50)});break;case"reset":$el.removeClass("link-clicked");break}})};$(".link-text-size").parents("a, button").add(".close-page-icon").linkTextSize();(function(){var tweens={"#home":new TweenLite.to("#home-container",.4,{z:-80,paused:true,ease:Power2.easeInOut}),"#login":new TimelineLite({paused:true}).from(".login-wrapper",.65,{x:"-100%",ease:Power2.easeInOut}),"#register":new TimelineLite({paused:true}).from(".register-wrapper",.65,{x:"100%",ease:Power2.easeInOut})},v={scrollTops:{},resetScrollTimeout:null,pageStatus:{showing:null}},f={getWrapper:function(viewKey){return $(tweens[viewKey].getChildren()[0]._targets[0]).parent()},showView:function(viewKey){var $wrapper=f.getWrapper(viewKey);$wrapper.scrollTop(0);$("body").scrollTop(v.scrollTops[viewKey]);v.pageStatus.selected=null;v.pageStatus.showing=viewKey;tweens[viewKey].play()},setViewFixed:function(viewKey,wrapperScrollTop){var $oldWrapper=f.getWrapper(viewKey);v.scrollTops[viewKey]=wrapperScrollTop;$oldWrapper.addClass("wrapper-anim-out").removeClass("wrapper-show");$("."+viewKey.substring(1)+"-outer").scrollTop(v.scrollTops[viewKey])}};function showPage(pageKey){if(pageKey&&!tweens[pageKey]){console.warn("Cannot show page, tween does not exist for that page",pageKey);pageKey=false}var $oldWrapper,pageToHide,wrapperScrollTop;if(v.pageStatus.showing){pageToHide=v.pageStatus.showing;$oldWrapper=f.getWrapper(pageToHide);wrapperScrollTop=$("body").scrollTop()}if(!pageKey){if(!pageToHide){tweens["#home"].reverse()}else{$("body").removeClass("home-behind");$("body").scrollTop(v.scrollTops.body);$oldWrapper.removeClass("wrapper-show").addClass("wrapper-anim-out");f.setViewFixed(pageToHide,wrapperScrollTop);tweens[pageToHide].eventCallback("onReverseComplete",function(){$oldWrapper.removeClass("wrapper-anim-out");tweens["#home"].reverse()});tweens[pageToHide].reverse();v.pageStatus.showing=null}}else{if(v.pageStatus.selected){var $selectedWrapper=f.getWrapper(v.pageStatus.selected);$selectedWrapper.removeClass("wrapper-show")}v.pageStatus.selected=pageKey;var $wrapper=f.getWrapper(pageKey);$wrapper.addClass("wrapper-show");if(!v.scrollTops[pageKey]){v.scrollTops[pageKey]=0}if(!pageToHide){v.scrollTops.body=$("body").scrollTop();$("body").addClass("home-behind");$(".home-outer").scrollTop(v.scrollTops.body);tweens["#home"].eventCallback("onComplete",f.showView,[pageKey]);tweens["#home"].play()}else{f.setViewFixed(pageToHide,wrapperScrollTop);tweens[pageToHide].eventCallback("onReverseComplete",function(){$oldWrapper.removeClass("wrapper-anim-out")});tweens[pageToHide].reverse();f.showView(pageKey)}}}(function(){function hashChangeEvent(init){if(init!==true&&videoPlaying){introVideo.pause()}if(location.hash==="#login"||location.hash==="#register"){showPage(location.hash)}else{showPage()}}$(window).on("hashchange",hashChangeEvent);introTimeline.eventCallback("onComplete",function(){hashChangeEvent(true)})})()})();(function(){var $inputs={regPass:$("#fos_user_registration_form_plainPassword_first")};$inputs.regPass.on("change keyup",function(){var pw=$inputs.regPass.val(),validCls;hasValidCls=$("#pw-letter").hasClass("valid");if(/[a-z]/i.test(pw)){if(!hasValidCls){$("#pw-letter").addClass("valid")}}else{if(hasValidCls){$("#pw-letter").removeClass("valid")}}hasValidCls=$("#pw-number").hasClass("valid");if(/\d/.test(pw)){if(!hasValidCls){$("#pw-number").addClass("valid")}}else{if(hasValidCls){$("#pw-number").removeClass("valid")}}hasValidCls=$("#pw-6").hasClass("valid");if(pw.length>=6){if(!hasValidCls){$("#pw-6").addClass("valid")}}else{if(hasValidCls){$("#pw-6").removeClass("valid")}}})})();(function(){$("#loginCollapse").on("show.bs.collapse",function(){$("#loginForm").attr("action",$("#loginForm").attr("data-loginAction"));$("#username").attr("name","_username")});$("#forgotCollapse").on("show.bs.collapse",function(){$("#loginForm").attr("action",$("#loginForm").attr("data-forgotAction"));$("#username").attr("name","username")});$("#resettingModal").on("hidden.bs.modal",function(e){if(!$("#loginCollapse").hasClass("show")){$("#showLoginForm").trigger("click.bs.collapse.data-api")}});$.fn.errorMessage=function(message,noFlash){this.each(function(){var $input=$(this);var f={init:function(){if(!$input.next().is(".form-control-feedback")||$input.parents(".form-group").length<1){return false}var $feedback=$input.next();$input.data("errorElements",{$feedback:$feedback,$formGroup:$input.parents(".form-group"),$form:$input.parents("form")}).data("isError",false).data("flashTimeline",new TimelineLite({onComplete:function(){$feedback.css({backgroundColor:""})}})).data("validateTimeout",null);return true},public_hide:function(){$input.data("isError",false);new TweenLite.to($input.data("errorElements").$feedback[0],.4,{opacity:0,y:"-100%",onComplete:function(){$input.data("errorElements").$feedback.empty()}});new TweenLite.to($input.data("errorElements").$formGroup[0],.4,{paddingBottom:0})}};if(typeof $input.data("errorElements")=="undefined"||message=="init"){var initSuccess=f.init();if(message=="init"||!initSuccess){return}}if(typeof f["public_"+message]=="function"){f["public_"+message]()}else{$input.data("isError",true);var currentMessage=$input.data("errorElements").$feedback.html();$input.data("errorElements").$feedback.html(message);if(currentMessage===message&&!noFlash){var flashCol=$("button.btn",$input.data("errorElements").$form).css("backgroundColor");$input.data("flashTimeline").clear().set($input.data("errorElements").$feedback[0],{backgroundColor:"rgba(255, 255, 255, 0)"}).to($input.data("errorElements").$feedback[0],.3,{backgroundColor:flashCol}).to($input.data("errorElements").$feedback[0],.6,{backgroundColor:"rgba(100, 100, 100, 0)"},"+=0.3")}new TweenLite.to($input.data("errorElements").$feedback[0],.4,{opacity:1,y:"0%"});new TweenLite.to($input.data("errorElements").$formGroup[0],.4,{paddingBottom:$input.data("errorElements").$feedback.outerHeight()})}});return this};$.fn.ajaxForm=function(){this.each(function(){var $form=$(this),$inputs=$(":input",$form).not("[type=submit]");var submitFunction=function(overrideData,$input,eventType){var serializedData=$input?$input.serializeArray():$inputs.serializeArray(),hidErr=function(){if($input){$input.errorMessage("hide")}else{$inputs.errorMessage("hide")}},buttonTextReset=function(){$("button[type=submit]",$form).linkTextSize("reset")},formData={};if($input){serializedData.push({name:"task[input]",value:$input.attr("id")});serializedData.push({name:"task[submit]",value:"no"})}$.each(serializedData,function(){formData[this.name]=this.value});if(overrideData&&typeof overrideData=="object"){formData=$.extend(formData,overrideData)}$.ajax({type:"POST",url:$form.attr("action"),data:formData,statusCode:{200:function(response){hidErr();window.location.href=response.href},401:function(response){hidErr();buttonTextReset();$("#password").errorMessage(response.responseJSON.message)},201:function(response){hidErr();window.location.href=response.href},202:function(response){hidErr();if(response.message){$("#modal_notice").html(response.message);$("#resettingModal").modal()}},400:function(response){hidErr();buttonTextReset();$.each(response.responseJSON,function(inputID,inputError){var $input=$("#"+inputID);$input.errorMessage(inputError,eventType==="keyup"?true:false)})}},error:function(err){if(err.status!==400&&err.status!==401){alert("Sorry, an unknown error occurred. Please try again.");buttonTextReset();console.warn(arguments)}},dataType:"json"})},inputEvent=function(e){var $input=$(this);if(e.type=="keyup"&&!$input.data("isError")){return}if($input.data("validateTimeout")){clearTimeout($input.data("validateTimeout"))}$input.data("validateTimeout",setTimeout(function(){var overrideData={};if($input.attr("id")==="fos_user_registration_form_plainPassword_first"){overrideData["fos_user_registration_form[plainPassword][second]"]=$input.val()}else if($input.attr("id")==="fos_user_registration_form_plainPassword_second"){overrideData["fos_user_registration_form[plainPassword][second]"]=$input.val();$input=$("#fos_user_registration_form_plainPassword_first")}submitFunction(overrideData,$input,e.type)},e.type=="keyup"?200:0))};$form.on("submit",function(e){e.preventDefault();var overrideData={};if($form.attr("name")=="fos_user_registration_form"){overrideData["fos_user_registration_form[username]"]=$("#fos_user_registration_form_email").val()}submitFunction(overrideData,null,e.type)});if($form.attr("name")=="fos_user_registration_form"){$inputs.errorMessage("init").on("keyup blur",inputEvent)}else{$inputs.errorMessage("init").on("keyup",function(){$inputs.errorMessage("hide")})}});return this};$(".fos_user_registration_register, .fos_user_security_check").ajaxForm()})();